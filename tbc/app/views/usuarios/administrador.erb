# encoding: utf-8
<div class="navbar navbar-default navbar-fixed-top" style="margin-bottom:0;background:white">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="#inicio">
        <i class='fa fa-rocket'></i>
        TBC
      </a>
    </div>
    <div class='collapse navbar-collapse'>
      <ul class='nav navbar-nav'>
        <li>
          <a href="#inicio">Administrador</a>
        </li>
      </ul>
    </div>
  </div>
</div>
<div class="container-fluid" style="margin-top:50px;">
  <div class="col-md-3 text-center" style="padding-top:30px;">
    <h2>Servicios</h2>
    <div class="btn-group-vertical" role="group" aria-label="...">
      <button id="btn-inventario" class="btn btn-default">Ver Inventario</button>
      <button id="btn-monitorear" class="btn btn-default">Monitorear Vehículos</button>
      <button id="btn-estaciones" class="btn btn-default">Ver estado de estaciones</button>
      <button id="btn-reportets" class="btn btn-default">Ver reportes de tranvías</button>
      <button id="btn-reportems" class="btn btn-default">Ver reportes de mobibuses</button>
      <button id="btn-accidentes" class="btn btn-default">Ver accidentes/emergencias</button>
    </div>
  </div>
  <div id="panel-contenido" class="col-md-6 text-center" style="padding-top:100px">
    <i class="fa fa-user fa-5x"></i>
    <h2>Desde aquí puedes acceder a todos los servicios de administrador. Selecciona una opción a la izquierda para comenzar.</h2>
  </div>
  <div class="col-md-3" style="padding-top:135px">
    <div id='transp-toolbar' class='btn-group-vertical' role='group' aria-label='...' style="display:none">
      <button id='btn-tranvia' class='btn btn-default'><i class='fa fa-train'></i>Tranvías</button>
      <button id='btn-mobibus' class='btn btn-default'><i class='fa fa-cab'></i>Mobibuses</button>
      <button id='btn-vcub' class='btn btn-default'><i class='fa fa-bicycle'></i>Vcubs</button>
    </div>
  </div>
</div>

<script type="text/javascript">
    var funcion="";
    $("#btn-inventario").click(function(){
        $("#panel-contenido").empty();
        funcion="inventario";
        verToolbar();
        $("#btn-tranvia").click();
    });
    $("#btn-tranvia").click(function(){
        if(funcion==="inventario") {
            cargarTranvias();
        }
    });
    $("#btn-mobibus").click(function(){
        if(funcion==="inventario"){
            cargarMobibuses();
        }
    });
    $("#btn-vcub").click(function(){
        if(funcion==="inventario"){
            cargarVcubs();
        }
        else if(funcion==="monitorear"){
            mensajeError("vcub");
        }
    });
    $("#btn-monitorear").click(function(){
        $("#panel-contenido").empty();
        funcion="monitorear";
        verToolbar();
    });
    $("#btn-reportets").click(function(){
        ocultarToolbar();
        cargarReportets();
    });
    $("#btn-reportems").click(function(){
        ocultarToolbar();
        cargarReportems();
    });
    $("#btn-accidentes").click(function(){
        ocultarToolbar();
        cargarAccidentes();
    });
    function cargarTranvias(){
        $("#panel-contenido").empty();
        $("#panel-contenido").append("<i class='fa fa-spinner fa-pulse fa-5x'></i>");
        var toapp= "<table class='table table-bordered table-striped'>" +
                "   <caption>Tranvías</caption>" +
                "   <thead>"+
                "   <tr>" +
                "       <th>ID</th>" +
                "       <th>Línea</th>" +
                "       <th>KMs última revisión</th>" +
                "       <th>Temperatura</th>" +
                "       <th>Posición</th>" +
                "       <th>Estado</th>" +
                "   <tr>"+
                "   </thead>" +
                "   <tbody>";
        $.ajax({
            url: "http://localhost:3000/tranvia"
        }).done(function( data ) {
            $("#panel-contenido").empty();
            var arr= data;
            for(i=0;i<data.length;i++){
                console.log(data[i]);
                var t= data[i];
                toapp+="<tr><td>"+t.identificacion+"</td><td>"+t.linea+"</td><td>"+t.kilms_ultima_revision+"</td><td>"+t.temperatura+"</td><td>"+t.posicion+"</td><td>"+t.estado+"</td></tr>";
            }
            toapp+="</tbody>" +
                    "</table>"
            $("#panel-contenido").append(toapp);
        });
    }
    function cargarMobibuses(){
        $("#panel-contenido").empty();
        $("#panel-contenido").append("<i class='fa fa-spinner fa-pulse fa-5x'></i>");
        var toapp= "<table class='table table-bordered table-striped'>" +
                "   <caption>Mobibuses</caption>" +
                "   <thead>"+
                "   <tr>" +
                "       <th>ID</th>" +
                "       <th>KMs última revisión</th>" +
                "       <th>Posición</th>" +
                "       <th>Estado</th>" +
                "   <tr>"+
                "   </thead>" +
                "   <tbody>";
        $.ajax({
            url: "http://localhost:3000/mobibuses"
        }).done(function( data ) {
            $("#panel-contenido").empty();
            var arr= data;
            for(i=0;i<data.length;i++){
                console.log(data[i]);
                var t= data[i];
                toapp+="<tr><td>"+t.id+"</td><td>"+t.kilms_ultima_revision+"</td><td>"+t.posicion+"</td><td>"+t.estado+"</td></tr>";
            }
            toapp+="</tbody>" +
                    "</table>"
            $("#panel-contenido").append(toapp);
        });
    }
    function cargarVcubs(){
        $("#panel-contenido").empty();
        $("#panel-contenido").append("<i class='fa fa-spinner fa-pulse fa-5x'></i>");
        var toapp= "<table class='table table-bordered table-striped'>" +
                "   <caption>Vcubs</caption>" +
                "   <thead>"+
                "   <tr>" +
                "       <th>ID</th>" +
                "       <th>Posición</th>" +
                "       <th>Estado</th>" +
                "       <th>Prestada</th>" +
                "   <tr>"+
                "   </thead>" +
                "   <tbody>";
        $.ajax({
            url: "http://localhost:3000/vcubs"
        }).done(function( data ) {
            $("#panel-contenido").empty();
            var arr= data.slice(0,10);
            for(i=0;i<arr.length;i++){
                console.log(data[i]);
                var t= data[i];
                toapp+="<tr><td>"+t.id+"</td><td>"+t.posicion+"</td><td>"+t.estado+"</td><td>"+ t.prestada+"</td></tr>";
            }
            toapp+="</tbody>" +
                    "</table>"
            $("#panel-contenido").append(toapp);
        });
    }
    function cargarReportets(){
        $("#panel-contenido").empty();
        $("#panel-contenido").append("<i class='fa fa-spinner fa-pulse fa-5x'></i>");
        var toapp= "<table class='table table-bordered table-striped'>" +
                "   <caption>Reportes de Tranvías</caption>" +
                "   <thead>"+
                "   <tr>" +
                "       <th>ID</th>" +
                "       <th>Tranvia</th>" +
                "       <th>Fecha</th>" +
                "       <th>Trayectos</th>" +
                "       <th>Tiempo promedio</th>" +
                "   <tr>"+
                "   </thead>" +
                "   <tbody>";
        $.ajax({
            url: "http://localhost:3000/reportets"
        }).done(function( data ) {
            $("#panel-contenido").empty();
            var arr= data.slice(0,10);
            for(i=0;i<arr.length;i++){
                console.log(data[i]);
                var t= data[i];
                toapp+="<tr><td>"+t.id+"</td><td>"+t.tranvium_id+"</td><td>"+t.fecha+"</td><td>"+ t.trayectos+"</td><td>"+ t.tiempopromedio +"</td></tr>";
            }
            toapp+="</tbody>" +
                    "</table>"
            $("#panel-contenido").append(toapp);
        });
    }
    function cargarReportems(){
        $("#panel-contenido").empty();
        $("#panel-contenido").append("<i class='fa fa-spinner fa-pulse fa-5x'></i>");
        var toapp= "<table class='table table-bordered table-striped'>" +
                "   <caption>Reportes de Mobibuses</caption>" +
                "   <thead>"+
                "   <tr>" +
                "       <th>ID</th>" +
                "       <th>Mobibus</th>" +
                "       <th>Fecha</th>" +
                "       <th>Trayectos</th>" +
                "   <tr>"+
                "   </thead>" +
                "   <tbody>";
        $.ajax({
            url: "http://localhost:3000/reportems"
        }).done(function( data ) {
            $("#panel-contenido").empty();
            var arr= data.slice(0,10);
            for(i=0;i<arr.length;i++){
                console.log(data[i]);
                var t= data[i];
                toapp+="<tr><td>"+t.id+"</td><td>"+t.mobibus_id+"</td><td>"+t.fecha+"</td><td>"+ t.trayectos+"</td></tr>";
            }
            toapp+="</tbody>" +
                    "</table>"
            $("#panel-contenido").append(toapp);
        });
    }
    function cargarAccidentes(){
        $("#panel-contenido").empty();
        $("#panel-contenido").append("<i class='fa fa-spinner fa-pulse fa-5x'></i>");
        var toapp= "<table class='table table-bordered table-striped'>" +
                "   <caption>Emergencias/Accidentes</caption>" +
                "   <thead>"+
                "   <tr>" +
                "       <th>ID</th>" +
                "       <th>Magnitud</th>" +
                "       <th>Posición</th>" +
                "       <th>Tipo de vehículo</th>" +
                "       <th>ID del vehículo</th>" +
                "       <th>Fecha</th>" +
                "   <tr>"+
                "   </thead>" +
                "   <tbody>";
        $.ajax({
            url: "http://localhost:3000/emergencia"
        }).done(function( data ) {
            $("#panel-contenido").empty();
            var arr= data.slice(0,10);
            for(i=0;i<arr.length;i++){
                console.log(data[i]);
                var t= data[i];
                toapp+="<tr><td>"+t.id+"</td><td>"+t.magnitud+"</td><td>"+t.posicion+"</td><td>"+ t.tipo_vehiculo+"</td><td>"+ t.id_vehiculo+"</td><td>"+ t.fecha+"</td></tr>";
            }
            toapp+="</tbody>" +
                    "</table>"
            $("#panel-contenido").append(toapp);
        });
    }
    function verToolbar(){
        $("#transp-toolbar").css("display","inline-block");
    }
    function ocultarToolbar(){
        $("#transp-toolbar").css("display","none");
    }
    function mensajeError(x){
        $("#panel-contenido").append("<i class='fa fa-frown-o fa-5x'></i><h2>Lo sentimos. Este servicio aún no está disponible para "+x+"</h2>");
    }

</script>

